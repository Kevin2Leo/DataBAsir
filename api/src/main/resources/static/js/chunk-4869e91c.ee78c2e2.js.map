{"version":3,"sources":["webpack:///./src/views/Document.vue","webpack:///./src/api/Document.js","webpack:///./src/views/Document.vue?22f9","webpack:///./src/views/Document.vue?3319"],"names":["class","isShowNoDataPage","description","type","icon","round","size","onSyncProjectDocument","loading","state","loadings","handleSync","isShowLoadingPage","rows","init","gutter","span","style","groupId","onProjectDocumentVersionChange","databaseDocumentFilter","version","placeholder","clearable","databaseDocumentVersions","item","key","label","createAt","value","loadMoreDocumentVersions","loadingVersions","column","border","label-align","width","databaseDocument","databaseName","productName","productVersion","documentVersion","id","data","tables","prop","min-width","resizable","tableMeta","name","columns","length","fit","formatter","columnTypeFormat","indexes","triggers","toc","index","underline","onClickToc","child","childItem","childIndex","content","placement","bottom","base","getOneByProjectId","proejctId","parameters","axios","get","params","syncByProjectId","post","getVersionByProjectId","setup","route","databaseDocumentVersionFilter","page","databaseDocumentVersionTotalPages","projectId","messageNotify","msg","showClose","message","duration","fetchDatabaseMetaData","versionResp","totalPages","resp","errCode","errMessage","initTocByDocumentData","push","forEach","ele","document","getElementById","headerOffset","actualTop","offsetTop","current","offsetParent","window","scrollTo","top","behavior","decimalDigits","then","catch","debounce","element","fn","delay","timer","context","this","args","arguments","clearTimeout","setTimeout","apply","__exports__","render"],"mappings":"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","file":"js/chunk-4869e91c.ee78c2e2.js","sourcesContent":["<template>\r\n  <div v-if=\"isShowNoDataPage\">\r\n      <el-empty description=\"似乎还没有同步过文档\" >\r\n          <el-button type=\"primary\" icon='refresh' round size='large' @click=\"onSyncProjectDocument\" :loading=\"state.loadings.handleSync\">同步</el-button>\r\n      </el-empty>\r\n  </div>\r\n  <div v-else-if=\"isShowLoadingPage\">\r\n    <el-skeleton v-loading=\"!state.init\" :rows=\"12\" />\r\n  </div>\r\n  <div v-else>\r\n    <el-container class=\"document-container\">\r\n      <el-header>\r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"2\" v-require-roles=\"['SYS_OWNER', 'GROUP_OWNER?groupId='+state.groupId, 'GROUP_MEMBER?groupId='+state.groupId]\">\r\n              <el-button type=\"success\" style=\"width:100%\" icon=\"Refresh\" @click=\"onSyncProjectDocument\" :loading=\"state.loadings.handleSync\">同步</el-button>\r\n            </el-col>\r\n            <el-col :span=\"2\" v-require-roles=\"['SYS_OWNER', 'GROUP_OWNER?groupId='+state.groupId, 'GROUP_MEMBER?groupId='+state.groupId]\">\r\n                <el-button type=\"primary\" style=\"width:100%\" icon=\"Download\">导出</el-button>\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n                <el-select @change=\"onProjectDocumentVersionChange\" v-model=\"state.databaseDocumentFilter.version\" placeholder=\"历史版本\" v-select-more=\"loadMoreDocumentVersions\" v-loading=\"state.loadings.loadingVersions\" clearable>\r\n                  <el-option\r\n                  v-for=\"item in state.databaseDocumentVersions\"\r\n                  :key=\"item.version\"\r\n                  :label=\"'['+item.createAt +']->'+item.version+''\"\r\n                  :value=\"item.version\"\r\n                  >\r\n                  </el-option>\r\n              </el-select>\r\n            </el-col>\r\n          </el-row>\r\n      </el-header>\r\n      \r\n      <el-main class=\"document-content-wrapper\">\r\n        \r\n        <div class=\"document-content\">\r\n        <el-row>\r\n          <!-- database overview -->\r\n          <el-col>\r\n            <el-descriptions :column=\"1\" size=\"large\" border>\r\n              <el-descriptions-item label=\"Database Name\" label-align=\"left\" width='200px'>{{ state.databaseDocument.databaseName }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Product Name\" label-align=\"left\">{{ state.databaseDocument.productName }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Product Version\" label-align=\"left\">{{ state.databaseDocument.productVersion }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Document Version\" label-align=\"left\">{{ state.databaseDocument.documentVersion }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Create At\" label-align=\"left\">{{ state.databaseDocument.createAt }}</el-descriptions-item>\r\n            </el-descriptions>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- table overview -->\r\n        <el-row>\r\n          <el-col>\r\n            <h2 :id=\"state.databaseDocument.databaseName + '.overview'\">Overview</h2>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col>\r\n            <el-table :data=\"state.databaseDocument.tables\"  border width='80%'>\r\n              <el-table-column type=\"index\" />\r\n              <el-table-column prop=\"name\" label=\"Name\" min-width=\"160\" resizable />\r\n              <el-table-column prop=\"type\" label=\"Type\" width=\"200\"  resizable />\r\n              <el-table-column prop=\"comment\" label=\"comment\" min-width=\"160\" resizable />\r\n            </el-table>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- table details -->\r\n        <template v-for=\"tableMeta in state.databaseDocument.tables\" :key=\"tableMeta\">\r\n          <el-row>\r\n            <el-col>\r\n              <h2 :id=\"state.databaseDocument.databaseName + '.' + tableMeta.name\">{{ tableMeta.name }}</h2>\r\n            </el-col>\r\n          </el-row>\r\n          \r\n          <el-row>\r\n            <el-col v-if=\"tableMeta.columns.length > 0\">\r\n              <h3>Columns</h3>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col >\r\n              <el-table :data=\"tableMeta.columns\" border fit width='80%'>\r\n                <el-table-column type=\"index\" />\r\n                <el-table-column prop=\"name\" label=\"Name\" min-width=\"120\" />\r\n                <el-table-column prop=\"type\" :formatter=\"columnTypeFormat\" label=\"Type\" width=\"140\" />\r\n                <el-table-column prop=\"nullable\" label=\"Is Nullable\" width=\"120\" />\r\n                <el-table-column prop=\"autoIncrement\" label=\"Auto increment\" width=\"140\" />\r\n                <el-table-column prop=\"defaultValue\" label=\"default\" min-width=\"120\" />\r\n                <el-table-column prop=\"comment\" label=\"comment\"  />\r\n              </el-table>\r\n            </el-col>\r\n          </el-row>\r\n        \r\n          <div v-if=\"tableMeta.indexes.length > 0\">\r\n            <el-row>\r\n              <el-col>\r\n                <h3>Indexes</h3>            \r\n              </el-col>\r\n            </el-row>\r\n            <el-row>\r\n              <el-col >\r\n                <el-table :data=\"tableMeta.indexes\" border fit width='80%'>\r\n                  <el-table-column type=\"index\" />\r\n                  <el-table-column prop=\"name\" label=\"Name\" min-width=\"120\" />\r\n                  <el-table-column prop=\"isPrimary\" label=\"IsPrimary\" width=\"120\" />\r\n                  <el-table-column prop=\"isUnique\" label=\"Is Unique\" width=\"120\" />\r\n                  <el-table-column prop=\"columnNames\" label=\"Columns\" min-width=\"150\" />\r\n                </el-table>\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n          \r\n          <div  v-if=\"tableMeta.triggers.length > 0\">\r\n            <el-row>\r\n              <el-col>\r\n                <h3>Triggers</h3>\r\n              </el-col>\r\n            </el-row>\r\n            <el-row>\r\n              <el-col >\r\n                <el-table :data=\"tableMeta.triggers\" fit border width='80%'>\r\n                  <el-table-column type=\"index\" />\r\n                  <el-table-column prop=\"name\" label=\"Name\" min-width=\"120\" />\r\n                  <el-table-column prop=\"timing\" label=\"timing\" />\r\n                  <el-table-column prop=\"manipulation\" label=\"manipulation\" width=\"120\" />\r\n                  <el-table-column prop=\"statement\" label=\"statement\" />\r\n                  <el-table-column prop=\"creatAt\" label=\"creatAt\" width=\"150\" />\r\n                </el-table>\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n\r\n        </template>\r\n        </div>\r\n        <div class=\"toc-wrapper\">\r\n          <div class=\"toc\">\r\n            <ul>\r\n              <li v-for=\"(item, index) in state.toc\" :key=\"index\">\r\n                <el-link :underline=\"false\" @click=\"onClickToc(state.databaseDocument.databaseName +'.'+ item.name)\">\r\n                  {{ item.name }}\r\n                </el-link>\r\n                <ul>\r\n                  <li v-for=\"(childItem, childIndex) in item.child\" :key=\"index+'-'+childIndex\"><el-link :underline=\"false\">{{ childItem.name }}</el-link></li>\r\n                </ul>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n        <el-tooltip\r\n          content=\"回到顶部\"\r\n          placement=\"top\"\r\n        >\r\n          <el-backtop :bottom=\"100\"></el-backtop>\r\n        </el-tooltip>\r\n      </el-main>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n.toc-wrapper {\r\n  right:0;\r\n  top: 60;\r\n  z-index: 0;\r\n  bottom: auto;\r\n  padding-left: 60px;\r\n  margin-left: 10px;\r\n  \r\n}\r\n\r\n.toc {\r\n  top: 130px;\r\n  position: fixed;\r\n  margin-left: 0;\r\n  transform: scale(1, 1);\r\n  bottom:0;\r\n  position:fixed;\r\n  overflow-y:hidden;\r\n  overflow-x:hidden;\r\n}\r\n\r\n.toc:hover {\r\n  overflow-y: auto;\r\n}\r\n\r\n.toc-wrapper .toc ul {\r\n    list-style: none;\r\n    line-height: 1.7;\r\n}\r\n\r\n.document-content-wrapper {\r\n  display: flex;\r\n  margin: 0;\r\n  min-width: 50rem;\r\n}\r\n\r\n.document-content {\r\n  min-width: 50rem;\r\n}\r\n\r\n</style>\r\n\r\n<script>\r\nimport { reactive, computed } from 'vue'\r\nimport {  useRoute } from 'vue-router'\r\nimport { getOneByProjectId, syncByProjectId, getVersionByProjectId } from '@/api/Document'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute()\r\n    const state = reactive({\r\n      databaseDocumentVersionFilter: {\r\n        page: 0,\r\n        size: 10,\r\n      },\r\n      databaseDocumentVersions: [],\r\n      databaseDocumentVersionTotalPages: 0,\r\n      databaseDocumentFilter: {\r\n        version: null\r\n      },\r\n      databaseDocument: null,\r\n      toc: [],\r\n      init: false,\r\n      loadings: {\r\n        handleSync: false,\r\n        loadingVersions: false\r\n      },\r\n      projectId: null,\r\n      groupId: null\r\n    })\r\n\r\n    state.projectId = route.params.projectId\r\n    state.groupId = route.params.groupId\r\n    const isShowNoDataPage = computed(() => !state.databaseDocument && state.init)\r\n    const isShowLoadingPage = computed(() => !state.databaseDocument && !state.init)\r\n\r\n    const messageNotify = (type, msg) => {\r\n      ElMessage({\r\n            showClose: true,\r\n            message: msg,\r\n            type: type,\r\n            duration: 3 * 1000\r\n        });\r\n    }\r\n\r\n    const fetchDatabaseMetaData = async () => {\r\n      // fetch version\r\n      const versionResp = await getVersionByProjectId(route.params.projectId)\r\n      state.databaseDocumentVersions = versionResp.data.content\r\n      state.databaseDocumentVersionTotalPages = versionResp.data.totalPages\r\n\r\n      // fetch meta\r\n      const resp = await getOneByProjectId(route.params.projectId)\r\n      if (resp.errCode) {\r\n        messageNotify('error', '同步失败：'+resp.errMessage)\r\n      } else if (resp.data) {\r\n        state.databaseDocument = resp.data\r\n        initTocByDocumentData(resp.data)\r\n      } else {\r\n        messageNotify('warn', '无可用数据')\r\n      }\r\n      state.init = true\r\n    }\r\n\r\n    const initTocByDocumentData = (data) => {\r\n      state.toc.push({ name: 'overview', child: [] })\r\n      data.tables.forEach(item => {\r\n        const child = []\r\n        state.toc.push({ name: item.name, child: child })\r\n      })\r\n    }\r\n\r\n    const onClickToc = (id) => {\r\n      const ele = document.getElementById(id)\r\n      if (ele) {\r\n        var headerOffset = -100;\r\n        var actualTop = ele.offsetTop;\r\n        var current = ele.offsetParent;\r\n          while (current !== null){\r\n          actualTop += current.offsetTop;\r\n          current = current.offsetParent;\r\n        }\r\n        window.scrollTo({\r\n          top: actualTop + headerOffset,\r\n          behavior: \"smooth\"\r\n        })\r\n      }\r\n    }\r\n\r\n\r\n    const columnTypeFormat = (column) => {\r\n      if (column.decimalDigits == null) {\r\n        return column.type + '('+column.size+')' \r\n      } else {\r\n        return column.type + '('+column.size+', '+column.decimalDigits+')'\r\n      }\r\n    }\r\n\r\n    const onProjectDocumentVersionChange = async () => {\r\n      const resp =  await getOneByProjectId(route.params.projectId, state.databaseDocumentFilter)\r\n      if (resp.data) {\r\n        state.databaseDocument = resp.data\r\n        messageNotify('success', '切换成功')\r\n      } else {\r\n        messageNotify('warn', '无可用数据')\r\n      }\r\n    }\r\n\r\n    const onSyncProjectDocument = () => {\r\n      const projectId = route.params.projectId\r\n      state.loadings.handleSync = true\r\n      syncByProjectId(projectId)\r\n      .then(resp => {\r\n        if (!resp.errCode) {\r\n          fetchDatabaseMetaData()\r\n          messageNotify('success', '同步成功')\r\n        }\r\n        state.loadings.handleSync = false\r\n      })\r\n      .catch(() => state.loadings.handleSync = false)\r\n    }\r\n\r\n    const loadMoreDocumentVersions = debounce(async () => {\r\n        state.loadings.loadingVersions = true\r\n        if (state.databaseDocumentVersionFilter.page + 1  < state.databaseDocumentVersionTotalPages) {\r\n          state.databaseDocumentVersionFilter.page++\r\n          const versionResp = await  getVersionByProjectId(route.params.projectId, state.databaseDocumentVersionFilter)\r\n          state.databaseDocumentVersionTotalPages = versionResp.data.totalPages\r\n          if (versionResp.data.content.length > 0){\r\n            versionResp.data.content.forEach(element => state.databaseDocumentVersions.push(element))\r\n          }\r\n        }\r\n        state.loadings.loadingVersions = false\r\n    }, 800)\r\n\r\n    // 节流\r\n    function debounce(fn, delay) {\r\n      let timer = null\r\n      return function () {\r\n        let context = this\r\n        let args = arguments\r\n        if(timer) {\r\n            clearTimeout(timer)\r\n        }\r\n        timer = setTimeout(function () {\r\n          fn.apply(context, args)\r\n        }, delay)\r\n      }\r\n    }\r\n\r\n    fetchDatabaseMetaData()\r\n\r\n    return {\r\n      state,\r\n      isShowNoDataPage,\r\n      isShowLoadingPage,\r\n      onClickToc,\r\n      columnTypeFormat,\r\n      loadMoreDocumentVersions,\r\n      onProjectDocumentVersionChange,\r\n      onSyncProjectDocument\r\n    }\r\n  }\r\n}\r\n\r\n</script>","import axios from '@/utils/fetch';\r\n\r\nconst base = '/api/v1.0'\r\n\r\nexport const getOneByProjectId = (proejctId, parameters) => {\r\n    return axios.get(base + '/projects/'+proejctId+'/documents', {\r\n        params: parameters\r\n    })\r\n}\r\n\r\nexport const syncByProjectId = (proejctId) => {\r\n    return axios.post(base + \"/projects/\"+proejctId+\"/documents\")\r\n}\r\n\r\nexport const getVersionByProjectId =(proejctId, parameters) => {\r\n    return axios.get(base + \"/projects/\"+proejctId+\"/document_versions\", {\r\n        params: parameters\r\n    })\r\n}\r\n","import { render } from \"./Document.vue?vue&type=template&id=3e651cdc\"\nimport script from \"./Document.vue?vue&type=script&lang=js\"\nexport * from \"./Document.vue?vue&type=script&lang=js\"\n\nimport \"./Document.vue?vue&type=style&index=0&id=3e651cdc&lang=css\"\n\nimport exportComponent from \"E:\\\\git_workspace\\\\databasir-frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Document.vue?vue&type=style&index=0&id=3e651cdc&lang=css\""],"sourceRoot":""}